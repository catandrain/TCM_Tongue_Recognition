# 后端-图片识别详细需求

## 1.图像预处理
### 1.1像素处理
#### 1.1.1 功能说明
调整图片的像素大小
#### 1.1.2 需求详细说明
对图片大小进行统一像素调整
### 1.2降噪处理
#### 1.2.1 功能说明
对图片进行降噪处理，减少图片噪声
#### 1.2.2 需求详细设计
用均值滤波器对图片进行降噪
### 1.3舌体提取
#### 1.3.1功能说明
提取舌体
#### 1.3.2 需求详细说明
从图片中提取出舌体，其余像素点为黑色

## 2.训练舌象预测模型
### 2.1 数据管理
#### 2.1.1 功能说明
将数据集分为训练集、测试集、验证集
#### 2.1.2 需求详细设计
预先做出近10000个样本数据的数据集，将数据集进行划分并管理，增加增删数据样本功能
### 2.2 模型训练
#### 2.2.1 功能说明
对不同模型进行训练，观察损失函数值的变化
#### 2.2.2 需求详细设计
选择合适模型，调整好训练参数，对模型进行训练，并且时刻观察loss值的变化，如果达到预期可停止训练并保存模型

## 3.识别舌象
### 3.1 功能说明
对不同的特征用不同模型进行识别，识别出舌质、舌苔颜色、舌形状、舌态
### 3.2 需求详细设计
将预处理后的图片输入到各个模型中，预测出其舌质、舌苔颜色、舌形状、舌态

## 4.分析舌象，生成报告
### 4.1 分析舌象
#### 4.1.1 功能说明
分析舌象特征，给出用药建议
#### 4.1.2 需求详细设计
根据实际舌象的瘀斑、点刺、齿痕、裂纹等症状用文字显示舌象特征、临床病症以及饮食及用药建议
### 4.2 生成报告
#### 4.2.1 功能说明
生成诊断报告，供检查者下载查看
#### 4.2.2 需求详细设计
根据舌象的分析，生成报告并供下载接口，报告里包括舌象的特征、临床病症以及用药建议

## 5.更新舌象数据库
### 5.1功能说明
将舌象录入数据库存储并供系统自主学习
### 5.2 需求详细设计
将舌象图片打上标签，存入数据库用于同一用户复查时对比，同时作为数据集增加到数据管理处

## 6.更新用户诊断记录
### 6.1 功能说明
更新用户目前舌象记录
### 6.2 需求详细设计
在数据库中更新用户舌象诊断的记录，

-------------------
参考文献：
[1]魏翔宇,詹松华,周华,张钰莹.中医舌诊新技术的研究进展[J/OL].中国中医基础医学杂志:1-7[2020-11-03].http://kns.cnki.net/kcms/detail/11.3554.R.20201028.1712.004.html.
[2]马超. 中医舌诊图像分割和特征提取方法研究[D].重庆大学,2007.
## 专业术语定义
1. 舌色
每一类舌色、苔色进行RGB色值空间和HSI色彩空间统计，作为颜色特征的数据。
* 舌色颜色分类数据库：根据《中医临床舌诊图谱》可将舌色分为淡白、淡红、红、暗红、绛、紫、蓝和青色八种。
* 苔色可分为：白色苔类、黄色苔类、黑色苔类、灰色苔类等四类。
  
2. 舌象纹理
应用灰度差分统计方法对舌相表面纹理进行描述，作为舌相特征的数据。
* 舌质：分为老舌、嫩舌、光剥舌
* 舌苔纹理分为：腻苔、腐苔、糙苔

|参与者|用例|功能描述|
|---|---|---|
|专业医生|打标签|为测试期间所收集的用户舌相图打上对应的四类标签|
|后台人员|存入数据集|将打好标签的图片文件打包存入数据集|
|后台人员|数据集管理|对数据集做特定的增删改操作|
|后台人员|模型训练|利用收集的数据集训练四个舌诊分类模型|